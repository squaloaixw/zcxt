{"remainingRequest":"D:\\Java\\code\\zcxt\\xt\\client\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\Java\\code\\zcxt\\xt\\client\\src\\views\\modules\\qichexinxi\\list.vue?vue&type=style&index=0&id=ab3c8dd6&lang=scss&scoped=true","dependencies":[{"path":"D:\\Java\\code\\zcxt\\xt\\client\\src\\views\\modules\\qichexinxi\\list.vue","mtime":1764768812590},{"path":"D:\\Java\\code\\zcxt\\xt\\client\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\Java\\code\\zcxt\\xt\\client\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\Java\\code\\zcxt\\xt\\client\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"D:\\Java\\code\\zcxt\\xt\\client\\node_modules\\sass-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\Java\\code\\zcxt\\xt\\client\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\Java\\code\\zcxt\\xt\\client\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ci50ZXh0LWRhbmdlciB7CiAgY29sb3I6ICNGNTZDNkM7CiAgJjpob3ZlciB7CiAgICBjb2xvcjogI2ZmNDk0OTsKICB9Cn0K"},{"version":3,"sources":["list.vue"],"names":[],"mappings":";AAiRA;AACA;AACA;AACA;AACA;AACA","file":"list.vue","sourceRoot":"src/views/modules/qichexinxi","sourcesContent":["<template>\n  <div class=\"main-content\">\n    <template v-if=\"showFlag\">\n      <div class=\"search-box-card\">\n        <el-form :inline=\"true\" :model=\"searchForm\" @submit.native.prevent=\"search()\">\n          <el-form-item label=\"车牌号\">\n            <el-input v-model=\"searchForm.chepaihao\" placeholder=\"请输入车牌号\" clearable size=\"medium\"></el-input>\n          </el-form-item>\n          <el-form-item label=\"车辆品牌\">\n            <el-input v-model=\"searchForm.cheliangpinpai\" placeholder=\"请输入品牌\" clearable size=\"medium\"></el-input>\n          </el-form-item>\n          <el-form-item label=\"汽车类别\">\n            <el-select v-model=\"searchForm.qicheleibie\" placeholder=\"请选择类别\" clearable size=\"medium\">\n              <el-option v-for=\"(item,index) in qicheleibieOptions\" :key=\"index\" :label=\"item\" :value=\"item\"></el-option>\n            </el-select>\n          </el-form-item>\n          <el-form-item label=\"状态\">\n            <el-select v-model=\"searchForm.zhuangtai\" placeholder=\"请选择状态\" clearable size=\"medium\">\n              <el-option v-for=\"(item,index) in zhuangtaiOptions\" :key=\"index\" :label=\"item\" :value=\"item\"></el-option>\n            </el-select>\n          </el-form-item>\n          <el-form-item>\n            <el-button type=\"primary\" icon=\"el-icon-search\" @click=\"search()\" size=\"medium\">查询</el-button>\n            <el-button icon=\"el-icon-refresh\" @click=\"resetForm\" size=\"medium\">重置</el-button>\n\n            <el-button v-if=\"isAuth('qichexinxi','新增')\" type=\"success\" icon=\"el-icon-plus\" @click=\"addOrUpdateHandler()\" size=\"medium\">新增车辆</el-button>\n            <el-button v-if=\"isAuth('qichexinxi','删除')\" type=\"danger\" icon=\"el-icon-delete\" :disabled=\"dataListSelections.length <= 0\" @click=\"deleteHandler()\" size=\"medium\">批量删除</el-button>\n          </el-form-item>\n        </el-form>\n      </div>\n\n      <div class=\"table-box-card\">\n        <el-table :data=\"dataList\" border v-loading=\"dataListLoading\" @selection-change=\"selectionChangeHandler\" style=\"width: 100%;\">\n          <el-table-column type=\"selection\" header-align=\"center\" align=\"center\" width=\"50\"></el-table-column>\n          <el-table-column type=\"index\" header-align=\"center\" align=\"center\" label=\"序号\" width=\"60\"></el-table-column>\n\n          <el-table-column prop=\"chepaihao\" header-align=\"center\" align=\"center\" label=\"车牌号\" min-width=\"100\"></el-table-column>\n          <el-table-column prop=\"cheliangxinghao\" header-align=\"center\" align=\"center\" label=\"车辆型号\" show-overflow-tooltip></el-table-column>\n          <el-table-column prop=\"cheliangpinpai\" header-align=\"center\" align=\"center\" label=\"品牌\"></el-table-column>\n          <el-table-column prop=\"qicheleibie\" header-align=\"center\" align=\"center\" label=\"类别\">\n            <template slot-scope=\"scope\">\n              <el-tag size=\"small\">{{ scope.row.qicheleibie }}</el-tag>\n            </template>\n          </el-table-column>\n\n          <el-table-column prop=\"cheliangzhaopian\" header-align=\"center\" align=\"center\" width=\"120\" label=\"车辆照片\">\n            <template slot-scope=\"scope\">\n              <div v-if=\"scope.row.cheliangzhaopian\">\n                <el-image\n                    class=\"table-img\"\n                    :src=\"scope.row.cheliangzhaopian.split(',')[0].indexOf('http') == 0 ? scope.row.cheliangzhaopian.split(',')[0] : $base.url + scope.row.cheliangzhaopian.split(',')[0]\"\n                    :preview-src-list=\"[scope.row.cheliangzhaopian.split(',')[0].indexOf('http') == 0 ? scope.row.cheliangzhaopian.split(',')[0] : $base.url + scope.row.cheliangzhaopian.split(',')[0]]\">\n                </el-image>\n              </div>\n              <div v-else>无图</div>\n            </template>\n          </el-table-column>\n\n          <el-table-column prop=\"jiage\" header-align=\"center\" align=\"center\" label=\"日租金\">\n            <template slot-scope=\"scope\">\n              <span style=\"color: #F56C6C; font-weight: bold;\">￥{{ scope.row.jiage }}</span>\n            </template>\n          </el-table-column>\n\n          <el-table-column prop=\"zhuangtai\" header-align=\"center\" align=\"center\" label=\"状态\">\n            <template slot-scope=\"scope\">\n              <el-tag :type=\"scope.row.zhuangtai === '已出租' ? 'warning' : 'success'\" effect=\"dark\" size=\"small\">{{ scope.row.zhuangtai }}</el-tag>\n            </template>\n          </el-table-column>\n\n          <el-table-column header-align=\"center\" align=\"center\" width=\"220\" label=\"操作\" fixed=\"right\">\n            <template slot-scope=\"scope\">\n              <el-button v-if=\"isAuth('qichexinxi','查看')\" type=\"text\" icon=\"el-icon-view\" size=\"small\" @click=\"addOrUpdateHandler(scope.row.id,'info')\">详情</el-button>\n              <el-button v-if=\"isAuth('qichexinxi','租赁汽车')\" type=\"text\" icon=\"el-icon-shopping-cart-full\" size=\"small\" @click=\"zuchedingdanCrossAddOrUpdateHandler(scope.row,'cross','','zhuangtai','该车辆已出租','已出租,未出租'.split(',')[0])\">租赁</el-button>\n              <el-button v-if=\"isAuth('qichexinxi','修改')\" type=\"text\" icon=\"el-icon-edit\" size=\"small\" @click=\"addOrUpdateHandler(scope.row.id)\">修改</el-button>\n              <el-button v-if=\"isAuth('qichexinxi','删除')\" type=\"text\" icon=\"el-icon-delete\" class=\"text-danger\" size=\"small\" @click=\"deleteHandler(scope.row.id)\">删除</el-button>\n            </template>\n          </el-table-column>\n        </el-table>\n\n        <el-pagination\n            @size-change=\"sizeChangeHandle\"\n            @current-change=\"currentChangeHandle\"\n            :current-page=\"pageIndex\"\n            :page-sizes=\"[10, 20, 50, 100]\"\n            :page-size=\"pageSize\"\n            :total=\"totalPage\"\n            layout=\"total, sizes, prev, pager, next, jumper\"\n            background\n            class=\"pagination-content\">\n        </el-pagination>\n      </div>\n    </template>\n\n    <add-or-update v-if=\"addOrUpdateFlag\" :parent=\"this\" ref=\"addOrUpdate\"></add-or-update>\n    <zuchedingdan-cross-add-or-update v-if=\"zuchedingdanCrossAddOrUpdateFlag\" :parent=\"this\" ref=\"zuchedingdanCrossaddOrUpdate\"></zuchedingdan-cross-add-or-update>\n  </div>\n</template>\n\n<script>\nimport AddOrUpdate from \"./add-or-update\";\nimport zuchedingdanCrossAddOrUpdate from \"../zuchedingdan/add-or-update\";\nexport default {\n  data() {\n    return {\n      qicheleibieOptions: [],\n      zhuangtaiOptions: [],\n      searchForm: {\n        chepaihao: \"\",\n        qicheleibie: \"\",\n        cheliangpinpai: \"\",\n        zhuangtai: \"\"\n      },\n      dataList: [],\n      pageIndex: 1,\n      pageSize: 10,\n      totalPage: 0,\n      dataListLoading: false,\n      dataListSelections: [],\n      showFlag: true,\n      addOrUpdateFlag:false,\n      zuchedingdanCrossAddOrUpdateFlag: false,\n    };\n  },\n  components: {\n    AddOrUpdate,\n    zuchedingdanCrossAddOrUpdate,\n  },\n  created() {\n    this.init();\n    this.getDataList();\n  },\n  methods: {\n    init () {\n      this.$http({\n        url: `option/qicheleibie/qicheleibie`,\n        method: \"get\"\n      }).then(({ data }) => {\n        if (data && data.code === 0) {\n          this.qicheleibieOptions = data.data;\n        }\n      });\n      this.zhuangtaiOptions = \"已出租,未出租\".split(',')\n    },\n    // 重置按钮逻辑\n    resetForm() {\n      this.searchForm = {\n        chepaihao: \"\",\n        qicheleibie: \"\",\n        cheliangpinpai: \"\",\n        zhuangtai: \"\"\n      };\n      this.search();\n    },\n    search() {\n      this.pageIndex = 1;\n      this.getDataList();\n    },\n    getDataList() {\n      this.dataListLoading = true;\n      let params = {\n        page: this.pageIndex,\n        limit: this.pageSize,\n        sort: 'id',\n        order: 'desc',\n        ...this.searchForm\n      }\n      // 清理空值\n      for(let key in params){\n        if(params[key] === '' || params[key] === undefined){\n          delete params[key];\n        } else if(key !== 'page' && key !== 'limit' && key !== 'sort' && key !== 'order'){\n          params[key] = '%' + params[key] + '%' // 模糊查询处理\n          // 对于下拉框，通常是精确匹配\n          if(key === 'qicheleibie' || key === 'zhuangtai') params[key] = this.searchForm[key];\n        }\n      }\n\n      this.$http({\n        url: \"qichexinxi/page\",\n        method: \"get\",\n        params: params\n      }).then(({ data }) => {\n        if (data && data.code === 0) {\n          this.dataList = data.data.list;\n          this.totalPage = data.data.total;\n        } else {\n          this.dataList = [];\n          this.totalPage = 0;\n        }\n        this.dataListLoading = false;\n      });\n    },\n    sizeChangeHandle(val) {\n      this.pageSize = val;\n      this.pageIndex = 1;\n      this.getDataList();\n    },\n    currentChangeHandle(val) {\n      this.pageIndex = val;\n      this.getDataList();\n    },\n    selectionChangeHandler(val) {\n      this.dataListSelections = val;\n    },\n    addOrUpdateHandler(id,type) {\n      this.showFlag = false;\n      this.addOrUpdateFlag = true;\n      this.crossAddOrUpdateFlag = false;\n      if(type!='info'){\n        type = 'else';\n      }\n      this.$nextTick(() => {\n        this.$refs.addOrUpdate.init(id,type);\n      });\n    },\n    zuchedingdanCrossAddOrUpdateHandler(row,type,crossOptAudit,statusColumnName,tips,statusColumnValue){\n      this.showFlag = false;\n      this.addOrUpdateFlag = false;\n      this.zuchedingdanCrossAddOrUpdateFlag = true;\n      this.$storage.set('crossObj',row);\n      this.$storage.set('crossTable','qichexinxi');\n      this.$storage.set('statusColumnName',statusColumnName);\n      this.$storage.set('statusColumnValue',statusColumnValue);\n      this.$storage.set('tips',tips);\n      if(statusColumnName!=''&&!statusColumnName.startsWith(\"[\")) {\n        var obj = this.$storage.getObj('crossObj');\n        for (var o in obj){\n          if(o==statusColumnName && obj[o]==statusColumnValue){\n            this.$message({\n              message: tips,\n              type: \"success\",\n              duration: 1500,\n              onClose: () => {\n                this.getDataList();\n              }\n            });\n            this.showFlag = true;\n            this.zuchedingdanCrossAddOrUpdateFlag = false;\n            return;\n          }\n        }\n      }\n      this.$nextTick(() => {\n        this.$refs.zuchedingdanCrossaddOrUpdate.init(row.id,type);\n      });\n    },\n    deleteHandler(id) {\n      var ids = id ? [Number(id)] : this.dataListSelections.map(item => Number(item.id));\n      this.$confirm(`确定进行[${id ? \"删除\" : \"批量删除\"}]操作?`, \"提示\", {\n        confirmButtonText: \"确定\",\n        cancelButtonText: \"取消\",\n        type: \"warning\"\n      }).then(() => {\n        this.$http({\n          url: \"qichexinxi/delete\",\n          method: \"post\",\n          data: ids\n        }).then(({ data }) => {\n          if (data && data.code === 0) {\n            this.$message.success(\"操作成功\");\n            this.search();\n          } else {\n            this.$message.error(data.msg);\n          }\n        });\n      });\n    },\n  }\n};\n</script>\n\n<style lang=\"scss\" scoped>\n.text-danger {\n  color: #F56C6C;\n  &:hover {\n    color: #ff4949;\n  }\n}\n</style>\n"]}]}