{"remainingRequest":"D:\\Java\\code\\zcxt\\xt\\front\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\Java\\code\\zcxt\\xt\\front\\src\\pages\\center\\center.vue?vue&type=style&index=0&id=a495080a&lang=scss&scoped=true","dependencies":[{"path":"D:\\Java\\code\\zcxt\\xt\\front\\src\\pages\\center\\center.vue","mtime":1765166036578},{"path":"D:\\Java\\code\\zcxt\\xt\\front\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\Java\\code\\zcxt\\xt\\front\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\Java\\code\\zcxt\\xt\\front\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"D:\\Java\\code\\zcxt\\xt\\front\\node_modules\\sass-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\Java\\code\\zcxt\\xt\\front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\Java\\code\\zcxt\\xt\\front\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQouY2VudGVyLWNvbnRhaW5lciB7DQogIHdpZHRoOiAxMjAwcHg7DQogIG1hcmdpbjogMjBweCBhdXRvOw0KICBkaXNwbGF5OiBmbGV4Ow0KICBnYXA6IDIwcHg7DQp9DQoNCi8qIOW3puS+p+i+ueagjyAqLw0KLnNpZGViYXItd3JhcHBlciB7DQogIHdpZHRoOiAyODBweDsNCiAgYmFja2dyb3VuZDogI2ZmZjsNCiAgYm9yZGVyLXJhZGl1czogOHB4Ow0KICBib3gtc2hhZG93OiAwIDFweCA0cHggcmdiYSgwLDAsMCwwLjA1KTsNCiAgcGFkZGluZzogMzBweCAyMHB4Ow0KICBoZWlnaHQ6IGZpdC1jb250ZW50Ow0KDQogIC51c2VyLXByb2ZpbGUtY2FyZCB7DQogICAgdGV4dC1hbGlnbjogY2VudGVyOw0KICAgIG1hcmdpbi1ib3R0b206IDMwcHg7DQogICAgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkICNmMGYwZjA7DQogICAgcGFkZGluZy1ib3R0b206IDIwcHg7DQoNCiAgICAuYXZhdGFyLWJveCB7DQogICAgICB3aWR0aDogMTAwcHg7DQogICAgICBoZWlnaHQ6IDEwMHB4Ow0KICAgICAgbWFyZ2luOiAwIGF1dG8gMTVweDsNCiAgICAgIGJvcmRlci1yYWRpdXM6IDUwJTsNCiAgICAgIG92ZXJmbG93OiBoaWRkZW47DQogICAgICBib3JkZXI6IDJweCBzb2xpZCAjZTBlMGUwOw0KICAgICAgaW1nIHsgd2lkdGg6IDEwMCU7IGhlaWdodDogMTAwJTsgb2JqZWN0LWZpdDogY292ZXI7IH0NCiAgICB9DQoNCiAgICAudXNlci1uYW1lIHsNCiAgICAgIGZvbnQtc2l6ZTogMThweDsNCiAgICAgIGZvbnQtd2VpZ2h0OiBib2xkOw0KICAgICAgY29sb3I6ICMzMzM7DQogICAgICBtYXJnaW4tYm90dG9tOiA1cHg7DQogICAgfQ0KDQogICAgLnVzZXItcm9sZSB7DQogICAgICBmb250LXNpemU6IDEycHg7DQogICAgICBjb2xvcjogIzk5OTsNCiAgICAgIG1hcmdpbi1ib3R0b206IDEwcHg7DQogICAgfQ0KDQogICAgLnZpcC10YWcgew0KICAgICAgZm9udC1zaXplOiAxMnB4Ow0KICAgICAgcGFkZGluZzogMnB4IDhweDsNCiAgICAgIGJvcmRlci1yYWRpdXM6IDEwcHg7DQogICAgICBiYWNrZ3JvdW5kOiAjZWVlOw0KICAgICAgY29sb3I6ICM2NjY7DQogICAgICAmLmFjdGl2ZSB7IGJhY2tncm91bmQ6ICNmZmY3ZTY7IGNvbG9yOiAjZmY5OTAwOyBib3JkZXI6IDFweCBzb2xpZCAjZmZjYzgwOyB9DQogICAgfQ0KICB9DQoNCiAgLnNpZGUtbWVudSB7DQogICAgLm1lbnUtaXRlbSB7DQogICAgICBwYWRkaW5nOiAxMnB4IDE1cHg7DQogICAgICBjdXJzb3I6IHBvaW50ZXI7DQogICAgICBib3JkZXItcmFkaXVzOiA2cHg7DQogICAgICBjb2xvcjogIzY2NjsNCiAgICAgIHRyYW5zaXRpb246IGJhY2tncm91bmQgMC4zczsNCiAgICAgIG1hcmdpbi1ib3R0b206IDVweDsNCg0KICAgICAgJjpob3ZlciB7IGJhY2tncm91bmQ6ICNmNWY3ZmE7IGNvbG9yOiAjMDBjMjkyOyB9DQogICAgICAmLmFjdGl2ZSB7IGJhY2tncm91bmQ6ICNlNmY5ZjQ7IGNvbG9yOiAjMDBjMjkyOyBmb250LXdlaWdodDogNTAwOyB9DQogICAgICAmLmRhbmdlciB7IGNvbG9yOiAjZjU2YzZjOyAmOmhvdmVyIHsgYmFja2dyb3VuZDogI2ZlZjBmMDsgfSB9DQogICAgfQ0KICB9DQp9DQoNCi8qIOWPs+S+p+WGheWuueWMuiAqLw0KLmNvbnRlbnQtd3JhcHBlciB7DQogIGZsZXg6IDE7DQogIGJhY2tncm91bmQ6ICNmZmY7DQogIGJvcmRlci1yYWRpdXM6IDhweDsNCiAgYm94LXNoYWRvdzogMCAxcHggNHB4IHJnYmEoMCwwLDAsMC4wNSk7DQogIHBhZGRpbmc6IDMwcHggNDBweDsNCg0KICAucGFuZWwtaGVhZGVyIHsNCiAgICBib3JkZXItYm90dG9tOiAxcHggc29saWQgI2YwZjBmMDsNCiAgICBtYXJnaW4tYm90dG9tOiAzMHB4Ow0KICAgIHBhZGRpbmctYm90dG9tOiAxNXB4Ow0KICAgIGgzIHsgbWFyZ2luOiAwOyBmb250LXNpemU6IDIwcHg7IGNvbG9yOiAjMzMzOyB9DQogIH0NCg0KICAudXNlci1mb3JtIHsNCiAgICBtYXgtd2lkdGg6IDYwMHB4Ow0KICB9DQoNCiAgLmJhbGFuY2UtYm94IHsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogICAgLm1vbmV5IHsgZm9udC1zaXplOiAyMHB4OyBmb250LXdlaWdodDogYm9sZDsgY29sb3I6ICNmZjUwMDA7IG1hcmdpbi1yaWdodDogMjBweDsgfQ0KICB9DQoNCiAgLmF2YXRhci11cGxvYWRlciB7DQogICAgL2RlZXAvIC5lbC11cGxvYWQgew0KICAgICAgYm9yZGVyOiAxcHggZGFzaGVkICNkOWQ5ZDk7DQogICAgICBib3JkZXItcmFkaXVzOiA2cHg7DQogICAgICBjdXJzb3I6IHBvaW50ZXI7DQogICAgICBwb3NpdGlvbjogcmVsYXRpdmU7DQogICAgICBvdmVyZmxvdzogaGlkZGVuOw0KICAgICAgJjpob3ZlciB7IGJvcmRlci1jb2xvcjogIzAwYzI5MjsgfQ0KICAgIH0NCiAgICAuYXZhdGFyLXVwbG9hZGVyLWljb24gew0KICAgICAgZm9udC1zaXplOiAyOHB4Ow0KICAgICAgY29sb3I6ICM4YzkzOWQ7DQogICAgICB3aWR0aDogMTAwcHg7DQogICAgICBoZWlnaHQ6IDEwMHB4Ow0KICAgICAgbGluZS1oZWlnaHQ6IDEwMHB4Ow0KICAgICAgdGV4dC1hbGlnbjogY2VudGVyOw0KICAgIH0NCiAgICAuYXZhdGFyIHsNCiAgICAgIHdpZHRoOiAxMDBweDsNCiAgICAgIGhlaWdodDogMTAwcHg7DQogICAgICBkaXNwbGF5OiBibG9jazsNCiAgICAgIG9iamVjdC1maXQ6IGNvdmVyOw0KICAgIH0NCiAgfQ0KfQ0K"},{"version":3,"sources":["center.vue"],"names":[],"mappings":";AA2LA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"center.vue","sourceRoot":"src/pages/center","sourcesContent":["<template>\r\n  <div class=\"center-container\">\r\n    <div class=\"sidebar-wrapper\">\r\n      <div class=\"user-profile-card\">\r\n        <div class=\"avatar-box\">\r\n          <img :src=\"sessionForm.touxiang ? baseUrl + sessionForm.touxiang : require('@/assets/touxiang.png')\" alt=\"Avatar\">\r\n        </div>\r\n        <div class=\"user-name\">{{ sessionForm.xingming || sessionForm.guanlixingming || sessionForm.zhanghao }}</div>\r\n        <div class=\"user-role\">{{ userTableName == 'yonghu' ? '普通用户' : '管理员' }}</div>\r\n      </div>\r\n\r\n      <div class=\"side-menu\">\r\n        <div class=\"menu-item active\">个人资料</div>\r\n        <div class=\"menu-item\" @click=\"$router.push('/index/myForumList')\">我的发布</div>\r\n        <div class=\"menu-item\" @click=\"toStoreup\">我的收藏</div>\r\n        <div class=\"menu-item danger\" @click=\"logout\">退出登录</div>\r\n      </div>\r\n    </div>\r\n\r\n    <div class=\"content-wrapper\">\r\n      <div class=\"panel-header\">\r\n        <h3>个人资料设置</h3>\r\n      </div>\r\n\r\n      <el-form ref=\"sessionForm\" :model=\"sessionForm\" :rules=\"rules\" label-width=\"100px\" class=\"user-form\">\r\n        <template v-if=\"userTableName=='yonghu'\">\r\n          <el-form-item label=\"账号\" prop=\"zhanghao\">\r\n            <el-input v-model=\"sessionForm.zhanghao\" readonly disabled></el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"姓名\" prop=\"xingming\">\r\n            <el-input v-model=\"sessionForm.xingming\"></el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"性别\">\r\n            <el-radio-group v-model=\"sessionForm.xingbie\">\r\n              <el-radio label=\"男\">男</el-radio>\r\n              <el-radio label=\"女\">女</el-radio>\r\n            </el-radio-group>\r\n          </el-form-item>\r\n          <el-form-item label=\"手机号\" prop=\"shouji\">\r\n            <el-input v-model=\"sessionForm.shouji\"></el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"身份证\" prop=\"shenfenzheng\">\r\n            <el-input v-model=\"sessionForm.shenfenzheng\"></el-input>\r\n          </el-form-item>\r\n        </template>\r\n\r\n        <template v-if=\"userTableName=='putongguanliyuan'\">\r\n          <el-form-item label=\"管理账号\" prop=\"guanlizhanghao\">\r\n            <el-input v-model=\"sessionForm.guanlizhanghao\" readonly disabled></el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"姓名\" prop=\"guanlixingming\">\r\n            <el-input v-model=\"sessionForm.guanlixingming\"></el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"联系电话\" prop=\"lianxidianhua\">\r\n            <el-input v-model=\"sessionForm.lianxidianhua\"></el-input>\r\n          </el-form-item>\r\n        </template>\r\n\r\n        <el-form-item label=\"头像上传\">\r\n          <el-upload\r\n              class=\"avatar-uploader\"\r\n              :action=\"uploadUrl\"\r\n              :headers=\"headers\"\r\n              :show-file-list=\"false\"\r\n              :on-success=\"handleAvatarSuccess\">\r\n            <img v-if=\"sessionForm.touxiang\" :src=\"baseUrl + sessionForm.touxiang\" class=\"avatar\">\r\n            <i v-else class=\"el-icon-plus avatar-uploader-icon\"></i>\r\n          </el-upload>\r\n        </el-form-item>\r\n\r\n        <el-form-item>\r\n          <el-button type=\"primary\" @click=\"onSubmit('sessionForm')\">保存修改</el-button>\r\n        </el-form-item>\r\n      </el-form>\r\n    </div>\r\n\r\n    <el-dialog title=\"账户充值\" :visible.sync=\"dialogFormVisibleMoney\" width=\"500px\">\r\n      <el-form :model=\"chongzhiForm\">\r\n        <el-form-item label=\"充值金额\">\r\n          <el-input type=\"number\" v-model=\"chongzhiForm.money\" placeholder=\"请输入金额\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"支付方式\">\r\n          <el-radio-group v-model=\"chongzhiForm.radio\">\r\n            <el-radio label=\"微信支付\">微信</el-radio>\r\n            <el-radio label=\"支付宝支付\">支付宝</el-radio>\r\n          </el-radio-group>\r\n        </el-form-item>\r\n      </el-form>\r\n      <div slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button @click=\"dialogFormVisibleMoney = false\">取 消</el-button>\r\n        <el-button type=\"primary\" @click=\"chongzhi\">确 认</el-button>\r\n      </div>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport config from '@/config/config'\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      baseUrl: config.baseUrl,\r\n      // 【修复点】：login.vue 中存储的键名为 sessionTable，这里必须一致，否则为 null 导致接口 404\r\n      userTableName: localStorage.getItem('sessionTable'),\r\n      sessionForm: {},\r\n      headers: { Token: localStorage.getItem('Token') },\r\n      uploadUrl: config.baseUrl + 'file/upload',\r\n      rules: {\r\n        xingming: [{ required: true, message: '请输入姓名', trigger: 'blur' }],\r\n        shouji: [{ validator: this.$validate.isMobile, trigger: 'blur' }],\r\n        shenfenzheng: [{ validator: this.$validate.isIdCard, trigger: 'blur' }]\r\n      },\r\n      dialogFormVisibleMoney: false,\r\n      dialogFormVisibleVip: false,\r\n      chongzhiForm: { money: '', radio: '微信支付' }\r\n    };\r\n  },\r\n  created() {\r\n    this.getSession();\r\n  },\r\n  methods: {\r\n    getSession() {\r\n      // 如果 userTableName 为空，直接跳转回登录，避免发送错误请求\r\n      if(!this.userTableName) {\r\n        this.$router.push('/login');\r\n        return;\r\n      }\r\n      this.$http.get(`${this.userTableName}/session`).then(res => {\r\n        if (res.data.code == 0) {\r\n          this.sessionForm = res.data.data;\r\n          // 防止头像路径为空时的报错\r\n          if(!this.sessionForm.touxiang) this.sessionForm.touxiang = '';\r\n        }\r\n      });\r\n    },\r\n    handleAvatarSuccess(res) {\r\n      if (res.code == 0) {\r\n        this.sessionForm.touxiang = 'upload/' + res.file;\r\n        this.$forceUpdate();\r\n      }\r\n    },\r\n    onSubmit() {\r\n      this.$refs.sessionForm.validate(valid => {\r\n        if (valid) {\r\n          this.$http.post(`${this.userTableName}/update`, this.sessionForm).then(res => {\r\n            if (res.data.code == 0) {\r\n              this.$message.success('个人信息更新成功');\r\n              this.getSession(); // 刷新数据\r\n            }\r\n          });\r\n        }\r\n      });\r\n    },\r\n    chongzhi() {\r\n      if (!this.chongzhiForm.money || this.chongzhiForm.money <= 0) return this.$message.error('请输入有效金额');\r\n\r\n      this.sessionForm.money = parseFloat(this.sessionForm.money) + parseFloat(this.chongzhiForm.money);\r\n      this.$http.post(`${this.userTableName}/update`, this.sessionForm).then(res => {\r\n        if (res.data.code == 0) {\r\n          this.$message.success('充值成功');\r\n          this.dialogFormVisibleMoney = false;\r\n        }\r\n      });\r\n    },\r\n    chongzhivip() {\r\n      this.sessionForm.vip = '是';\r\n      this.$http.post(`${this.userTableName}/update`, this.sessionForm).then(res => {\r\n        if (res.data.code == 0) {\r\n          this.$message.success('开通成功，您已成为尊贵VIP');\r\n          this.dialogFormVisibleVip = false;\r\n          localStorage.setItem('vip', '是');\r\n        }\r\n      });\r\n    },\r\n    toStoreup() {\r\n      this.$router.push('/index/storeup');\r\n    },\r\n    logout() {\r\n      localStorage.clear();\r\n      this.$router.push('/index/home');\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.center-container {\r\n  width: 1200px;\r\n  margin: 20px auto;\r\n  display: flex;\r\n  gap: 20px;\r\n}\r\n\r\n/* 左侧边栏 */\r\n.sidebar-wrapper {\r\n  width: 280px;\r\n  background: #fff;\r\n  border-radius: 8px;\r\n  box-shadow: 0 1px 4px rgba(0,0,0,0.05);\r\n  padding: 30px 20px;\r\n  height: fit-content;\r\n\r\n  .user-profile-card {\r\n    text-align: center;\r\n    margin-bottom: 30px;\r\n    border-bottom: 1px solid #f0f0f0;\r\n    padding-bottom: 20px;\r\n\r\n    .avatar-box {\r\n      width: 100px;\r\n      height: 100px;\r\n      margin: 0 auto 15px;\r\n      border-radius: 50%;\r\n      overflow: hidden;\r\n      border: 2px solid #e0e0e0;\r\n      img { width: 100%; height: 100%; object-fit: cover; }\r\n    }\r\n\r\n    .user-name {\r\n      font-size: 18px;\r\n      font-weight: bold;\r\n      color: #333;\r\n      margin-bottom: 5px;\r\n    }\r\n\r\n    .user-role {\r\n      font-size: 12px;\r\n      color: #999;\r\n      margin-bottom: 10px;\r\n    }\r\n\r\n    .vip-tag {\r\n      font-size: 12px;\r\n      padding: 2px 8px;\r\n      border-radius: 10px;\r\n      background: #eee;\r\n      color: #666;\r\n      &.active { background: #fff7e6; color: #ff9900; border: 1px solid #ffcc80; }\r\n    }\r\n  }\r\n\r\n  .side-menu {\r\n    .menu-item {\r\n      padding: 12px 15px;\r\n      cursor: pointer;\r\n      border-radius: 6px;\r\n      color: #666;\r\n      transition: background 0.3s;\r\n      margin-bottom: 5px;\r\n\r\n      &:hover { background: #f5f7fa; color: #00c292; }\r\n      &.active { background: #e6f9f4; color: #00c292; font-weight: 500; }\r\n      &.danger { color: #f56c6c; &:hover { background: #fef0f0; } }\r\n    }\r\n  }\r\n}\r\n\r\n/* 右侧内容区 */\r\n.content-wrapper {\r\n  flex: 1;\r\n  background: #fff;\r\n  border-radius: 8px;\r\n  box-shadow: 0 1px 4px rgba(0,0,0,0.05);\r\n  padding: 30px 40px;\r\n\r\n  .panel-header {\r\n    border-bottom: 1px solid #f0f0f0;\r\n    margin-bottom: 30px;\r\n    padding-bottom: 15px;\r\n    h3 { margin: 0; font-size: 20px; color: #333; }\r\n  }\r\n\r\n  .user-form {\r\n    max-width: 600px;\r\n  }\r\n\r\n  .balance-box {\r\n    display: flex;\r\n    align-items: center;\r\n    .money { font-size: 20px; font-weight: bold; color: #ff5000; margin-right: 20px; }\r\n  }\r\n\r\n  .avatar-uploader {\r\n    /deep/ .el-upload {\r\n      border: 1px dashed #d9d9d9;\r\n      border-radius: 6px;\r\n      cursor: pointer;\r\n      position: relative;\r\n      overflow: hidden;\r\n      &:hover { border-color: #00c292; }\r\n    }\r\n    .avatar-uploader-icon {\r\n      font-size: 28px;\r\n      color: #8c939d;\r\n      width: 100px;\r\n      height: 100px;\r\n      line-height: 100px;\r\n      text-align: center;\r\n    }\r\n    .avatar {\r\n      width: 100px;\r\n      height: 100px;\r\n      display: block;\r\n      object-fit: cover;\r\n    }\r\n  }\r\n}\r\n</style>\r\n"]}]}