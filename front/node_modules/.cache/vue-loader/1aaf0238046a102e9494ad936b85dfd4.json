{"remainingRequest":"D:\\Java\\code\\zcxt\\xt\\front\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\Java\\code\\zcxt\\xt\\front\\src\\pages\\qichezixun\\detail.vue?vue&type=style&index=0&id=16fb4a32&lang=scss&scoped=true","dependencies":[{"path":"D:\\Java\\code\\zcxt\\xt\\front\\src\\pages\\qichezixun\\detail.vue","mtime":1765097796018},{"path":"D:\\Java\\code\\zcxt\\xt\\front\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\Java\\code\\zcxt\\xt\\front\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\Java\\code\\zcxt\\xt\\front\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"D:\\Java\\code\\zcxt\\xt\\front\\node_modules\\sass-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\Java\\code\\zcxt\\xt\\front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\Java\\code\\zcxt\\xt\\front\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQouZGV0YWlsLWNvbnRhaW5lciB7DQogIHdpZHRoOiAxMDAlOw0KICBiYWNrZ3JvdW5kLWNvbG9yOiAjZjVmN2ZhOw0KICBtaW4taGVpZ2h0OiAxMDB2aDsNCiAgcGFkZGluZy1ib3R0b206IDQwcHg7DQp9DQoNCi5sb2FkaW5nLXN0YXRlIHsNCiAgcGFkZGluZzogNTBweDsNCiAgdGV4dC1hbGlnbjogY2VudGVyOw0KICBjb2xvcjogIzk5OTsNCiAgZm9udC1zaXplOiAxNnB4Ow0KfQ0KDQouYnJlYWRjcnVtYi1ib3ggew0KICB3aWR0aDogMTIwMHB4Ow0KICBtYXJnaW46IDAgYXV0bzsNCiAgcGFkZGluZzogMjBweCAwOw0KfQ0KDQoubWFpbi1jb250ZW50IHsNCiAgd2lkdGg6IDEyMDBweDsNCiAgbWFyZ2luOiAwIGF1dG87DQp9DQoNCi8qIOmhtumDqOWMuuWfnyAqLw0KLnRvcC1zZWN0aW9uIHsNCiAgZGlzcGxheTogZmxleDsNCiAgYmFja2dyb3VuZDogI2ZmZjsNCiAgcGFkZGluZzogMjBweDsNCiAgYm9yZGVyLXJhZGl1czogOHB4Ow0KICBib3gtc2hhZG93OiAwIDRweCAxMnB4IHJnYmEoMCwgMCwgMCwgMC4wNSk7DQogIG1hcmdpbi1ib3R0b206IDIwcHg7DQogIGdhcDogMzBweDsNCn0NCg0KLmNhcm91c2VsLWJveCB7DQogIHdpZHRoOiA1MCU7DQogIGZsZXgtc2hyaW5rOiAwOw0KICBib3JkZXItcmFkaXVzOiA4cHg7DQogIG92ZXJmbG93OiBoaWRkZW47DQoNCiAgLyog5L+u5aSNIGVsLWNhcm91c2VsIOWGhemDqOWPr+iDveeahOWchuinkua6ouWHuiAqLw0KICAvZGVlcC8gLmVsLWNhcm91c2VsX19pdGVtIHsNCiAgICBib3JkZXItcmFkaXVzOiA4cHg7DQogIH0NCn0NCg0KLmltYWdlLXdyYXBwZXIgew0KICB3aWR0aDogMTAwJTsNCiAgaGVpZ2h0OiAxMDAlOw0KfQ0KDQouaW5mby1ib3ggew0KICBmbGV4OiAxOw0KICBkaXNwbGF5OiBmbGV4Ow0KICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOw0KDQogIC50aXRsZSB7DQogICAgZm9udC1zaXplOiAyNHB4Ow0KICAgIGNvbG9yOiAjMzMzOw0KICAgIG1hcmdpbjogMCAwIDE1cHggMDsNCiAgICBsaW5lLWhlaWdodDogMS40Ow0KICAgIGZvbnQtd2VpZ2h0OiA2MDA7DQogIH0NCg0KICAubWV0YS1yb3cgew0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgZ2FwOiAyMHB4Ow0KICAgIGNvbG9yOiAjOTk5Ow0KICAgIGZvbnQtc2l6ZTogMTRweDsNCiAgICBtYXJnaW4tYm90dG9tOiAyMHB4Ow0KDQogICAgLm1ldGEtaXRlbSB7DQogICAgICBkaXNwbGF5OiBmbGV4Ow0KICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAgICAgIGdhcDogNXB4Ow0KICAgIH0NCiAgfQ0KDQogIC5pbnRyby1ib3ggew0KICAgIGJhY2tncm91bmQ6ICNmOGY5ZmE7DQogICAgcGFkZGluZzogMTVweDsNCiAgICBib3JkZXItcmFkaXVzOiA2cHg7DQogICAgbWFyZ2luLWJvdHRvbTogMjBweDsNCiAgICBib3JkZXItbGVmdDogNHB4IHNvbGlkICM0MDlFRkY7DQoNCiAgICAubGFiZWwgew0KICAgICAgZm9udC13ZWlnaHQ6IGJvbGQ7DQogICAgICBtYXJnaW4tYm90dG9tOiA4cHg7DQogICAgICBjb2xvcjogIzY2NjsNCiAgICB9DQoNCiAgICAuY29udGVudCB7DQogICAgICBjb2xvcjogIzY2NjsNCiAgICAgIGxpbmUtaGVpZ2h0OiAxLjY7DQogICAgICBmb250LXNpemU6IDE0cHg7DQogICAgICBtYXgtaGVpZ2h0OiAxNTBweDsNCiAgICAgIG92ZXJmbG93LXk6IGF1dG87DQogICAgfQ0KICB9DQoNCiAgLmFjdGlvbnMgew0KICAgIG1hcmdpbi10b3A6IGF1dG87DQogICAgZGlzcGxheTogZmxleDsNCiAgICBnYXA6IDE1cHg7DQoNCiAgICAuc3RvcmUtYnRuIHsNCiAgICAgIGRpc3BsYXk6IGlubGluZS1mbGV4Ow0KICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAgICAgIGdhcDogNnB4Ow0KICAgICAgcGFkZGluZzogMTBweCAyNXB4Ow0KICAgICAgYm9yZGVyLXJhZGl1czogMjBweDsNCiAgICAgIGN1cnNvcjogcG9pbnRlcjsNCiAgICAgIGZvbnQtc2l6ZTogMTRweDsNCiAgICAgIHRyYW5zaXRpb246IGFsbCAwLjNzOw0KICAgICAgYm9yZGVyOiAxcHggc29saWQgI2RjZGZlNjsNCiAgICAgIGNvbG9yOiAjNjA2MjY2Ow0KICAgICAgYmFja2dyb3VuZDogI2ZmZjsNCg0KICAgICAgJjpob3ZlciB7DQogICAgICAgIGJvcmRlci1jb2xvcjogIzQwOUVGRjsNCiAgICAgICAgY29sb3I6ICM0MDlFRkY7DQogICAgICB9DQoNCiAgICAgICYuYWN0aXZlIHsNCiAgICAgICAgYmFja2dyb3VuZDogI2ZmZjsNCiAgICAgICAgYm9yZGVyLWNvbG9yOiAjZmZiYTAwOw0KICAgICAgICBjb2xvcjogI2ZmYmEwMDsNCiAgICAgIH0NCg0KICAgICAgaSB7DQogICAgICAgIGZvbnQtc2l6ZTogMTZweDsNCiAgICAgIH0NCiAgICB9DQogIH0NCn0NCg0KLyog5YaF5a655Yy65Z+fICovDQouY29udGVudC1zZWN0aW9uIHsNCiAgYmFja2dyb3VuZDogI2ZmZjsNCiAgYm9yZGVyLXJhZGl1czogOHB4Ow0KICBib3gtc2hhZG93OiAwIDRweCAxMnB4IHJnYmEoMCwgMCwgMCwgMC4wNSk7DQogIG1hcmdpbi1ib3R0b206IDIwcHg7DQogIG92ZXJmbG93OiBoaWRkZW47DQoNCiAgLyog5L2/55SoIC9kZWVwLyDmm7/ku6MgOjp2LWRlZXAg5Lul6I635b6X5pu05aW95YW85a655oCnICovDQogIC9kZWVwLyAuZWwtdGFicy0tYm9yZGVyLWNhcmQgew0KICAgIGJvcmRlcjogbm9uZTsNCiAgICBib3gtc2hhZG93OiBub25lOw0KICB9DQoNCiAgL2RlZXAvIC5lbC10YWJzX19oZWFkZXIgew0KICAgIGJhY2tncm91bmQtY29sb3I6ICNmNWY3ZmE7DQogICAgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkICNlNGU3ZWQ7DQogIH0NCg0KICAvZGVlcC8gLmVsLXRhYnNfX2l0ZW0uaXMtYWN0aXZlIHsNCiAgICBjb2xvcjogIzQwOUVGRjsNCiAgICBmb250LXdlaWdodDogYm9sZDsNCiAgICBib3JkZXItdG9wOiAycHggc29saWQgIzQwOUVGRjsgLyog5aKe5Yqg6YCJ5Lit5oCB55qE6aG26YOo6auY5LquICovDQogIH0NCg0KICAucmljaC10ZXh0IHsNCiAgICBwYWRkaW5nOiAyMHB4Ow0KICAgIG1pbi1oZWlnaHQ6IDMwMHB4Ow0KICAgIGxpbmUtaGVpZ2h0OiAxLjg7DQogICAgY29sb3I6ICMzMzM7DQoNCiAgICAvZGVlcC8gaW1nIHsNCiAgICAgIG1heC13aWR0aDogMTAwJTsNCiAgICAgIGhlaWdodDogYXV0bzsNCiAgICAgIGRpc3BsYXk6IGJsb2NrOw0KICAgICAgbWFyZ2luOiAxMHB4IGF1dG87DQogICAgfQ0KICB9DQp9DQoNCi8qIOeDremXqOaOqOiNkCAqLw0KLmhvdC1zZWN0aW9uIHsNCiAgYmFja2dyb3VuZDogI2ZmZjsNCiAgYm9yZGVyLXJhZGl1czogOHB4Ow0KICBib3gtc2hhZG93OiAwIDRweCAxMnB4IHJnYmEoMCwgMCwgMCwgMC4wNSk7DQogIHBhZGRpbmc6IDIwcHg7DQoNCiAgLnNlY3Rpb24taGVhZGVyIHsNCiAgICBib3JkZXItbGVmdDogNHB4IHNvbGlkICM0MDlFRkY7DQogICAgcGFkZGluZy1sZWZ0OiAxMHB4Ow0KICAgIGZvbnQtc2l6ZTogMThweDsNCiAgICBmb250LXdlaWdodDogYm9sZDsNCiAgICBtYXJnaW4tYm90dG9tOiAyMHB4Ow0KICAgIGNvbG9yOiAjMzMzOw0KICB9DQoNCiAgLmhvdC1saXN0IHsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjsNCiAgICBnYXA6IDIwcHg7DQogIH0NCg0KICAuaG90LWl0ZW0gew0KICAgIGZsZXg6IDE7DQogICAgY3Vyc29yOiBwb2ludGVyOw0KICAgIHRyYW5zaXRpb246IHRyYW5zZm9ybSAwLjNzOw0KICAgIGJhY2tncm91bmQ6ICNmZmY7DQoNCiAgICAmOmhvdmVyIHsNCiAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWSgtNXB4KTsNCg0KICAgICAgLmhvdC10aXRsZSB7DQogICAgICAgIGNvbG9yOiAjNDA5RUZGOw0KICAgICAgfQ0KICAgIH0NCg0KICAgIC5pbWctYm94IHsNCiAgICAgIHdpZHRoOiAxMDAlOw0KICAgICAgaGVpZ2h0OiAxNjBweDsNCiAgICAgIGJvcmRlci1yYWRpdXM6IDZweDsNCiAgICAgIG92ZXJmbG93OiBoaWRkZW47DQogICAgICBtYXJnaW4tYm90dG9tOiAxMHB4Ow0KICAgICAgYmFja2dyb3VuZDogI2VlZTsNCiAgICB9DQoNCiAgICAuaW5mbyB7DQogICAgICAuaG90LXRpdGxlIHsNCiAgICAgICAgZm9udC1zaXplOiAxNXB4Ow0KICAgICAgICBjb2xvcjogIzMzMzsNCiAgICAgICAgbWFyZ2luLWJvdHRvbTogNnB4Ow0KICAgICAgICBvdmVyZmxvdzogaGlkZGVuOw0KICAgICAgICB0ZXh0LW92ZXJmbG93OiBlbGxpcHNpczsNCiAgICAgICAgd2hpdGUtc3BhY2U6IG5vd3JhcDsNCiAgICAgICAgZm9udC13ZWlnaHQ6IDUwMDsNCiAgICAgIH0NCg0KICAgICAgLmhvdC1tZXRhIHsNCiAgICAgICAgZm9udC1zaXplOiAxMnB4Ow0KICAgICAgICBjb2xvcjogIzk5OTsNCiAgICAgIH0NCiAgICB9DQogIH0NCn0NCg=="},{"version":3,"sources":["detail.vue"],"names":[],"mappings":";AAkSA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA","file":"detail.vue","sourceRoot":"src/pages/qichezixun","sourcesContent":["<template>\r\n  <div class=\"detail-container\">\r\n    <div class=\"breadcrumb-box\">\r\n      <el-breadcrumb separator-class=\"el-icon-arrow-right\">\r\n        <el-breadcrumb-item :to=\"{ path: '/index' }\">首页</el-breadcrumb-item>\r\n        <el-breadcrumb-item>汽车资讯</el-breadcrumb-item>\r\n        <el-breadcrumb-item>详情</el-breadcrumb-item>\r\n      </el-breadcrumb>\r\n    </div>\r\n\r\n    <div class=\"main-content\" v-if=\"detail.id\">\r\n      <div class=\"top-section\">\r\n        <div class=\"carousel-box\">\r\n          <el-carousel trigger=\"click\" height=\"400px\" indicator-position=\"outside\">\r\n            <el-carousel-item v-for=\"(item, index) in detailBanner\" :key=\"index\">\r\n              <div class=\"image-wrapper\">\r\n                <el-image\r\n                    style=\"width: 100%; height: 100%\"\r\n                    :src=\"item.substr(0,4)=='http' ? item : baseUrl + item\"\r\n                    fit=\"cover\"\r\n                    class=\"carousel-image\">\r\n                </el-image>\r\n              </div>\r\n            </el-carousel-item>\r\n          </el-carousel>\r\n        </div>\r\n\r\n        <div class=\"info-box\">\r\n          <h1 class=\"title\">{{ detail.biaoti }}</h1>\r\n\r\n          <div class=\"meta-row\">\r\n            <span class=\"meta-item\"><i class=\"el-icon-time\"></i> {{ detail.fabushijian }}</span>\r\n            <span class=\"meta-item\"><i class=\"el-icon-user\"></i> {{ detail.faburen }}</span>\r\n            <span class=\"meta-item\"><i class=\"el-icon-view\"></i> {{ detail.clicknum }}次浏览</span>\r\n          </div>\r\n\r\n          <div class=\"intro-box\">\r\n            <div class=\"label\">简介：</div>\r\n            <div class=\"content\">{{ detail.jianjie }}</div>\r\n          </div>\r\n\r\n          <div class=\"actions\">\r\n            <div class=\"store-btn\" @click=\"storeup(1)\" v-if=\"!isStoreup\">\r\n              <i class=\"el-icon-star-off\"></i> 收藏资讯\r\n            </div>\r\n            <div class=\"store-btn active\" @click=\"storeup(-1)\" v-else>\r\n              <i class=\"el-icon-star-on\"></i> 已收藏\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div class=\"content-section\">\r\n        <el-tabs v-model=\"activeName\" type=\"border-card\">\r\n          <el-tab-pane label=\"详细内容\" name=\"first\">\r\n            <div class=\"rich-text\" v-html=\"detail.neirong\"></div>\r\n          </el-tab-pane>\r\n        </el-tabs>\r\n      </div>\r\n\r\n      <div class=\"hot-section\">\r\n        <div class=\"section-header\">\r\n          <span>热门推荐</span>\r\n        </div>\r\n        <div class=\"hot-list\">\r\n          <div\r\n              class=\"hot-item\"\r\n              v-for=\"item in hotList\"\r\n              :key=\"item.id\"\r\n              @click=\"toDetail(item)\"\r\n          >\r\n            <div class=\"img-box\">\r\n              <el-image\r\n                  v-if=\"item.fengmian\"\r\n                  style=\"width: 100%; height: 100%\"\r\n                  :src=\"baseUrl + item.fengmian.split(',')[0]\"\r\n                  fit=\"cover\">\r\n              </el-image>\r\n            </div>\r\n            <div class=\"info\">\r\n              <div class=\"hot-title\">{{ item.biaoti }}</div>\r\n              <div class=\"hot-meta\">{{ item.faburen }}</div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <div v-else class=\"loading-state\">\r\n      <i class=\"el-icon-loading\"></i> 正在加载详情...\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport CountDown from '@/components/CountDown';\r\n\r\nexport default {\r\n  //数据集合\r\n  data() {\r\n    return {\r\n      tablename: 'qichezixun',\r\n      baseUrl: '',\r\n      breadcrumbItem: [\r\n        {\r\n          name: '详情信息'\r\n        }\r\n      ],\r\n      title: '',\r\n      detailBanner: [],\r\n      endTime: 0,\r\n      hotList: [],\r\n      detail: {},\r\n      activeName: 'first',\r\n      total: 1,\r\n      pageSize: 5,\r\n      pageSizes: [10, 20, 30, 50],\r\n      totalPage: 1,\r\n      rules: {\r\n        content: [\r\n          { required: true, message: '请输入内容', trigger: 'blur' }\r\n        ]\r\n      },\r\n      storeupParams: {\r\n        name: '',\r\n        picture: '',\r\n        refid: 0,\r\n        tablename: 'qichezixun',\r\n        userid: localStorage.getItem('userid')\r\n      },\r\n      isStoreup: false,\r\n      storeupInfo: {},\r\n      buynumber: 1,\r\n    }\r\n  },\r\n  created() {\r\n    this.init();\r\n  },\r\n  //方法集合\r\n  methods: {\r\n    init() {\r\n      this.baseUrl = this.$config.baseUrl;\r\n\r\n      // --- 核心修复：兼容多种参数传递方式 ---\r\n      // 1. 如果 URL 中直接包含 id 参数 (如 ?id=81)\r\n      if(this.$route.query.id) {\r\n        this.detail.id = this.$route.query.id;\r\n      }\r\n      // 2. 如果 URL 包含 detailObj 对象字符串\r\n      if (this.$route.query.detailObj) {\r\n        this.detail = JSON.parse(this.$route.query.detailObj);\r\n      }\r\n      // 3. 如果从收藏页跳转过来\r\n      if (this.$route.query.storeupObj) {\r\n        this.detail.id = JSON.parse(this.$route.query.storeupObj).refid;\r\n      }\r\n\r\n      // --- 确保获取到 ID 后再发起请求，避免 undefined 错误 ---\r\n      if (this.detail.id) {\r\n        this.$http.get(this.tablename + '/detail/' + this.detail.id, {}).then(res => {\r\n          if (res.data.code == 0) {\r\n            this.detail = res.data.data;\r\n            this.title = this.detail.biaoti;\r\n            this.detailBanner = this.detail.fengmian ? this.detail.fengmian.split(\",\") : [];\r\n            this.$forceUpdate();\r\n          }\r\n        });\r\n        // 获取收藏状态\r\n        this.getStoreupStatus();\r\n      } else {\r\n        console.warn(\"未获取到有效的 detail ID，无法请求数据\");\r\n      }\r\n\r\n      // 获取热门列表（不需要 ID）\r\n      this.getHotList();\r\n    },\r\n    toDetail(item) {\r\n      // 统一跳转逻辑，传递 detailObj\r\n      this.$router.push({ path: '/index/qichezixunDetail', query: { detailObj: JSON.stringify(item) } });\r\n      // 强制重新加载数据，因为是同路由跳转\r\n      this.detail = item;\r\n      this.init();\r\n      document.body.scrollTop = 0;\r\n      document.documentElement.scrollTop = 0;\r\n    },\r\n    getHotList() {\r\n      let autoSortUrl = \"qichezixun/autoSort\";\r\n      this.$http.get(autoSortUrl, {\r\n        params: {\r\n          page: 1,\r\n          limit: 4,\r\n        }\r\n      }).then(res => {\r\n        if (res.data.code == 0) {\r\n          this.hotList = res.data.data.list;\r\n        }\r\n      })\r\n    },\r\n    storeup(type) {\r\n      // 1. 校验数据完整性\r\n      if (!this.detail.id) {\r\n        this.$message.error('数据加载异常，无法操作');\r\n        return;\r\n      }\r\n\r\n      // 2. 核心修复：检查登录状态\r\n      // 必须实时获取 userid，不能依赖 data() 中初始化的值（因为可能是 null）\r\n      let userid = localStorage.getItem('userid');\r\n      if (!userid) {\r\n        this.$message.error('请先登录');\r\n        // 可选：自动跳转到登录页\r\n        // this.$router.push('/login');\r\n        return;\r\n      }\r\n\r\n      // 3. 准备请求参数\r\n      // 确保所有字段都有值，防止后端报空指针错误\r\n      this.storeupParams.userid = userid;\r\n      this.storeupParams.name = this.title;\r\n      // 安全获取图片，如果没有则传空字符串\r\n      this.storeupParams.picture = (this.detailBanner && this.detailBanner.length > 0) ? this.detailBanner[0] : '';\r\n      this.storeupParams.refid = this.detail.id;\r\n      this.storeupParams.type = type; // type=1 表示收藏\r\n\r\n      // 4. 执行收藏逻辑\r\n      if (type == 1 && !this.isStoreup) {\r\n        this.$http.post('storeup/add', this.storeupParams).then(res => {\r\n          if (res.data.code == 0) {\r\n            this.isStoreup = true;\r\n            // 收藏成功后，重新获取一下收藏信息，以便获取 storeupInfo.id 用于取消收藏\r\n            this.getStoreupStatus();\r\n            this.$message({\r\n              type: 'success',\r\n              message: '收藏成功!',\r\n              duration: 1500,\r\n            });\r\n          }\r\n        });\r\n      }\r\n\r\n      // 5. 执行取消收藏逻辑\r\n      if (type == -1 && this.isStoreup) {\r\n        if (!this.storeupInfo || !this.storeupInfo.id) {\r\n          this.$message.error('取消失败，无法获取收藏记录ID');\r\n          return;\r\n        }\r\n        let delIds = new Array();\r\n        delIds.push(this.storeupInfo.id);\r\n        this.$http.post('storeup/delete', delIds).then(res => {\r\n          if (res.data.code == 0) {\r\n            this.isStoreup = false;\r\n            this.storeupInfo = {}; // 清空信息\r\n            this.$message({\r\n              type: 'success',\r\n              message: '取消成功!',\r\n              duration: 1500,\r\n            });\r\n          }\r\n        });\r\n      }\r\n    },\r\n    getStoreupStatus() {\r\n      if (localStorage.getItem(\"Token\")) {\r\n        this.$http.get('storeup/list', { params: { page: 1, limit: 1, type: 1, refid: this.detail.id, tablename: 'qichezixun', userid: localStorage.getItem('userid') } }).then(res => {\r\n          if (res.data.code == 0 && res.data.data.list.length > 0) {\r\n            this.isStoreup = true;\r\n            this.storeupInfo = res.data.data.list[0];\r\n          }\r\n        });\r\n      }\r\n    },\r\n    download(file) {\r\n      if (!file) {\r\n        this.$message({\r\n          type: 'error',\r\n          message: '文件不存在',\r\n          duration: 1500,\r\n        });\r\n        return;\r\n      }\r\n      window.open(this.baseUrl + file)\r\n    },\r\n  },\r\n  components: {\r\n    CountDown\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.detail-container {\r\n  width: 100%;\r\n  background-color: #f5f7fa;\r\n  min-height: 100vh;\r\n  padding-bottom: 40px;\r\n}\r\n\r\n.loading-state {\r\n  padding: 50px;\r\n  text-align: center;\r\n  color: #999;\r\n  font-size: 16px;\r\n}\r\n\r\n.breadcrumb-box {\r\n  width: 1200px;\r\n  margin: 0 auto;\r\n  padding: 20px 0;\r\n}\r\n\r\n.main-content {\r\n  width: 1200px;\r\n  margin: 0 auto;\r\n}\r\n\r\n/* 顶部区域 */\r\n.top-section {\r\n  display: flex;\r\n  background: #fff;\r\n  padding: 20px;\r\n  border-radius: 8px;\r\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);\r\n  margin-bottom: 20px;\r\n  gap: 30px;\r\n}\r\n\r\n.carousel-box {\r\n  width: 50%;\r\n  flex-shrink: 0;\r\n  border-radius: 8px;\r\n  overflow: hidden;\r\n\r\n  /* 修复 el-carousel 内部可能的圆角溢出 */\r\n  /deep/ .el-carousel__item {\r\n    border-radius: 8px;\r\n  }\r\n}\r\n\r\n.image-wrapper {\r\n  width: 100%;\r\n  height: 100%;\r\n}\r\n\r\n.info-box {\r\n  flex: 1;\r\n  display: flex;\r\n  flex-direction: column;\r\n\r\n  .title {\r\n    font-size: 24px;\r\n    color: #333;\r\n    margin: 0 0 15px 0;\r\n    line-height: 1.4;\r\n    font-weight: 600;\r\n  }\r\n\r\n  .meta-row {\r\n    display: flex;\r\n    gap: 20px;\r\n    color: #999;\r\n    font-size: 14px;\r\n    margin-bottom: 20px;\r\n\r\n    .meta-item {\r\n      display: flex;\r\n      align-items: center;\r\n      gap: 5px;\r\n    }\r\n  }\r\n\r\n  .intro-box {\r\n    background: #f8f9fa;\r\n    padding: 15px;\r\n    border-radius: 6px;\r\n    margin-bottom: 20px;\r\n    border-left: 4px solid #409EFF;\r\n\r\n    .label {\r\n      font-weight: bold;\r\n      margin-bottom: 8px;\r\n      color: #666;\r\n    }\r\n\r\n    .content {\r\n      color: #666;\r\n      line-height: 1.6;\r\n      font-size: 14px;\r\n      max-height: 150px;\r\n      overflow-y: auto;\r\n    }\r\n  }\r\n\r\n  .actions {\r\n    margin-top: auto;\r\n    display: flex;\r\n    gap: 15px;\r\n\r\n    .store-btn {\r\n      display: inline-flex;\r\n      align-items: center;\r\n      gap: 6px;\r\n      padding: 10px 25px;\r\n      border-radius: 20px;\r\n      cursor: pointer;\r\n      font-size: 14px;\r\n      transition: all 0.3s;\r\n      border: 1px solid #dcdfe6;\r\n      color: #606266;\r\n      background: #fff;\r\n\r\n      &:hover {\r\n        border-color: #409EFF;\r\n        color: #409EFF;\r\n      }\r\n\r\n      &.active {\r\n        background: #fff;\r\n        border-color: #ffba00;\r\n        color: #ffba00;\r\n      }\r\n\r\n      i {\r\n        font-size: 16px;\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n/* 内容区域 */\r\n.content-section {\r\n  background: #fff;\r\n  border-radius: 8px;\r\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);\r\n  margin-bottom: 20px;\r\n  overflow: hidden;\r\n\r\n  /* 使用 /deep/ 替代 ::v-deep 以获得更好兼容性 */\r\n  /deep/ .el-tabs--border-card {\r\n    border: none;\r\n    box-shadow: none;\r\n  }\r\n\r\n  /deep/ .el-tabs__header {\r\n    background-color: #f5f7fa;\r\n    border-bottom: 1px solid #e4e7ed;\r\n  }\r\n\r\n  /deep/ .el-tabs__item.is-active {\r\n    color: #409EFF;\r\n    font-weight: bold;\r\n    border-top: 2px solid #409EFF; /* 增加选中态的顶部高亮 */\r\n  }\r\n\r\n  .rich-text {\r\n    padding: 20px;\r\n    min-height: 300px;\r\n    line-height: 1.8;\r\n    color: #333;\r\n\r\n    /deep/ img {\r\n      max-width: 100%;\r\n      height: auto;\r\n      display: block;\r\n      margin: 10px auto;\r\n    }\r\n  }\r\n}\r\n\r\n/* 热门推荐 */\r\n.hot-section {\r\n  background: #fff;\r\n  border-radius: 8px;\r\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);\r\n  padding: 20px;\r\n\r\n  .section-header {\r\n    border-left: 4px solid #409EFF;\r\n    padding-left: 10px;\r\n    font-size: 18px;\r\n    font-weight: bold;\r\n    margin-bottom: 20px;\r\n    color: #333;\r\n  }\r\n\r\n  .hot-list {\r\n    display: flex;\r\n    justify-content: space-between;\r\n    gap: 20px;\r\n  }\r\n\r\n  .hot-item {\r\n    flex: 1;\r\n    cursor: pointer;\r\n    transition: transform 0.3s;\r\n    background: #fff;\r\n\r\n    &:hover {\r\n      transform: translateY(-5px);\r\n\r\n      .hot-title {\r\n        color: #409EFF;\r\n      }\r\n    }\r\n\r\n    .img-box {\r\n      width: 100%;\r\n      height: 160px;\r\n      border-radius: 6px;\r\n      overflow: hidden;\r\n      margin-bottom: 10px;\r\n      background: #eee;\r\n    }\r\n\r\n    .info {\r\n      .hot-title {\r\n        font-size: 15px;\r\n        color: #333;\r\n        margin-bottom: 6px;\r\n        overflow: hidden;\r\n        text-overflow: ellipsis;\r\n        white-space: nowrap;\r\n        font-weight: 500;\r\n      }\r\n\r\n      .hot-meta {\r\n        font-size: 12px;\r\n        color: #999;\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>\r\n"]}]}