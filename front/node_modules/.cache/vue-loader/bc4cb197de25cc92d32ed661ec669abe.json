{"remainingRequest":"D:\\Java\\code\\zcxt\\xt\\front\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\Java\\code\\zcxt\\xt\\front\\src\\pages\\center\\center.vue?vue&type=script&lang=js","dependencies":[{"path":"D:\\Java\\code\\zcxt\\xt\\front\\src\\pages\\center\\center.vue","mtime":1765166036578},{"path":"D:\\Java\\code\\zcxt\\xt\\front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\Java\\code\\zcxt\\xt\\front\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"D:\\Java\\code\\zcxt\\xt\\front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\Java\\code\\zcxt\\xt\\front\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQppbXBvcnQgY29uZmlnIGZyb20gJ0AvY29uZmlnL2NvbmZpZycNCg0KZXhwb3J0IGRlZmF1bHQgew0KICBkYXRhKCkgew0KICAgIHJldHVybiB7DQogICAgICBiYXNlVXJsOiBjb25maWcuYmFzZVVybCwNCiAgICAgIC8vIOOAkOS/ruWkjeeCueOAke+8mmxvZ2luLnZ1ZSDkuK3lrZjlgqjnmoTplK7lkI3kuLogc2Vzc2lvblRhYmxl77yM6L+Z6YeM5b+F6aG75LiA6Ie077yM5ZCm5YiZ5Li6IG51bGwg5a+86Ie05o6l5Y+jIDQwNA0KICAgICAgdXNlclRhYmxlTmFtZTogbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3Nlc3Npb25UYWJsZScpLA0KICAgICAgc2Vzc2lvbkZvcm06IHt9LA0KICAgICAgaGVhZGVyczogeyBUb2tlbjogbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ1Rva2VuJykgfSwNCiAgICAgIHVwbG9hZFVybDogY29uZmlnLmJhc2VVcmwgKyAnZmlsZS91cGxvYWQnLA0KICAgICAgcnVsZXM6IHsNCiAgICAgICAgeGluZ21pbmc6IFt7IHJlcXVpcmVkOiB0cnVlLCBtZXNzYWdlOiAn6K+36L6T5YWl5aeT5ZCNJywgdHJpZ2dlcjogJ2JsdXInIH1dLA0KICAgICAgICBzaG91amk6IFt7IHZhbGlkYXRvcjogdGhpcy4kdmFsaWRhdGUuaXNNb2JpbGUsIHRyaWdnZXI6ICdibHVyJyB9XSwNCiAgICAgICAgc2hlbmZlbnpoZW5nOiBbeyB2YWxpZGF0b3I6IHRoaXMuJHZhbGlkYXRlLmlzSWRDYXJkLCB0cmlnZ2VyOiAnYmx1cicgfV0NCiAgICAgIH0sDQogICAgICBkaWFsb2dGb3JtVmlzaWJsZU1vbmV5OiBmYWxzZSwNCiAgICAgIGRpYWxvZ0Zvcm1WaXNpYmxlVmlwOiBmYWxzZSwNCiAgICAgIGNob25nemhpRm9ybTogeyBtb25leTogJycsIHJhZGlvOiAn5b6u5L+h5pSv5LuYJyB9DQogICAgfTsNCiAgfSwNCiAgY3JlYXRlZCgpIHsNCiAgICB0aGlzLmdldFNlc3Npb24oKTsNCiAgfSwNCiAgbWV0aG9kczogew0KICAgIGdldFNlc3Npb24oKSB7DQogICAgICAvLyDlpoLmnpwgdXNlclRhYmxlTmFtZSDkuLrnqbrvvIznm7TmjqXot7Povazlm57nmbvlvZXvvIzpgb/lhY3lj5HpgIHplJnor6/or7fmsYINCiAgICAgIGlmKCF0aGlzLnVzZXJUYWJsZU5hbWUpIHsNCiAgICAgICAgdGhpcy4kcm91dGVyLnB1c2goJy9sb2dpbicpOw0KICAgICAgICByZXR1cm47DQogICAgICB9DQogICAgICB0aGlzLiRodHRwLmdldChgJHt0aGlzLnVzZXJUYWJsZU5hbWV9L3Nlc3Npb25gKS50aGVuKHJlcyA9PiB7DQogICAgICAgIGlmIChyZXMuZGF0YS5jb2RlID09IDApIHsNCiAgICAgICAgICB0aGlzLnNlc3Npb25Gb3JtID0gcmVzLmRhdGEuZGF0YTsNCiAgICAgICAgICAvLyDpmLLmraLlpLTlg4/ot6/lvoTkuLrnqbrml7bnmoTmiqXplJkNCiAgICAgICAgICBpZighdGhpcy5zZXNzaW9uRm9ybS50b3V4aWFuZykgdGhpcy5zZXNzaW9uRm9ybS50b3V4aWFuZyA9ICcnOw0KICAgICAgICB9DQogICAgICB9KTsNCiAgICB9LA0KICAgIGhhbmRsZUF2YXRhclN1Y2Nlc3MocmVzKSB7DQogICAgICBpZiAocmVzLmNvZGUgPT0gMCkgew0KICAgICAgICB0aGlzLnNlc3Npb25Gb3JtLnRvdXhpYW5nID0gJ3VwbG9hZC8nICsgcmVzLmZpbGU7DQogICAgICAgIHRoaXMuJGZvcmNlVXBkYXRlKCk7DQogICAgICB9DQogICAgfSwNCiAgICBvblN1Ym1pdCgpIHsNCiAgICAgIHRoaXMuJHJlZnMuc2Vzc2lvbkZvcm0udmFsaWRhdGUodmFsaWQgPT4gew0KICAgICAgICBpZiAodmFsaWQpIHsNCiAgICAgICAgICB0aGlzLiRodHRwLnBvc3QoYCR7dGhpcy51c2VyVGFibGVOYW1lfS91cGRhdGVgLCB0aGlzLnNlc3Npb25Gb3JtKS50aGVuKHJlcyA9PiB7DQogICAgICAgICAgICBpZiAocmVzLmRhdGEuY29kZSA9PSAwKSB7DQogICAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2Uuc3VjY2Vzcygn5Liq5Lq65L+h5oGv5pu05paw5oiQ5YqfJyk7DQogICAgICAgICAgICAgIHRoaXMuZ2V0U2Vzc2lvbigpOyAvLyDliLfmlrDmlbDmja4NCiAgICAgICAgICAgIH0NCiAgICAgICAgICB9KTsNCiAgICAgICAgfQ0KICAgICAgfSk7DQogICAgfSwNCiAgICBjaG9uZ3poaSgpIHsNCiAgICAgIGlmICghdGhpcy5jaG9uZ3poaUZvcm0ubW9uZXkgfHwgdGhpcy5jaG9uZ3poaUZvcm0ubW9uZXkgPD0gMCkgcmV0dXJuIHRoaXMuJG1lc3NhZ2UuZXJyb3IoJ+ivt+i+k+WFpeacieaViOmHkeminScpOw0KDQogICAgICB0aGlzLnNlc3Npb25Gb3JtLm1vbmV5ID0gcGFyc2VGbG9hdCh0aGlzLnNlc3Npb25Gb3JtLm1vbmV5KSArIHBhcnNlRmxvYXQodGhpcy5jaG9uZ3poaUZvcm0ubW9uZXkpOw0KICAgICAgdGhpcy4kaHR0cC5wb3N0KGAke3RoaXMudXNlclRhYmxlTmFtZX0vdXBkYXRlYCwgdGhpcy5zZXNzaW9uRm9ybSkudGhlbihyZXMgPT4gew0KICAgICAgICBpZiAocmVzLmRhdGEuY29kZSA9PSAwKSB7DQogICAgICAgICAgdGhpcy4kbWVzc2FnZS5zdWNjZXNzKCflhYXlgLzmiJDlip8nKTsNCiAgICAgICAgICB0aGlzLmRpYWxvZ0Zvcm1WaXNpYmxlTW9uZXkgPSBmYWxzZTsNCiAgICAgICAgfQ0KICAgICAgfSk7DQogICAgfSwNCiAgICBjaG9uZ3poaXZpcCgpIHsNCiAgICAgIHRoaXMuc2Vzc2lvbkZvcm0udmlwID0gJ+aYryc7DQogICAgICB0aGlzLiRodHRwLnBvc3QoYCR7dGhpcy51c2VyVGFibGVOYW1lfS91cGRhdGVgLCB0aGlzLnNlc3Npb25Gb3JtKS50aGVuKHJlcyA9PiB7DQogICAgICAgIGlmIChyZXMuZGF0YS5jb2RlID09IDApIHsNCiAgICAgICAgICB0aGlzLiRtZXNzYWdlLnN1Y2Nlc3MoJ+W8gOmAmuaIkOWKn++8jOaCqOW3suaIkOS4uuWwiui0tVZJUCcpOw0KICAgICAgICAgIHRoaXMuZGlhbG9nRm9ybVZpc2libGVWaXAgPSBmYWxzZTsNCiAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgndmlwJywgJ+aYrycpOw0KICAgICAgICB9DQogICAgICB9KTsNCiAgICB9LA0KICAgIHRvU3RvcmV1cCgpIHsNCiAgICAgIHRoaXMuJHJvdXRlci5wdXNoKCcvaW5kZXgvc3RvcmV1cCcpOw0KICAgIH0sDQogICAgbG9nb3V0KCkgew0KICAgICAgbG9jYWxTdG9yYWdlLmNsZWFyKCk7DQogICAgICB0aGlzLiRyb3V0ZXIucHVzaCgnL2luZGV4L2hvbWUnKTsNCiAgICB9DQogIH0NCn07DQo="},{"version":3,"sources":["center.vue"],"names":[],"mappings":";AAiGA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"center.vue","sourceRoot":"src/pages/center","sourcesContent":["<template>\r\n  <div class=\"center-container\">\r\n    <div class=\"sidebar-wrapper\">\r\n      <div class=\"user-profile-card\">\r\n        <div class=\"avatar-box\">\r\n          <img :src=\"sessionForm.touxiang ? baseUrl + sessionForm.touxiang : require('@/assets/touxiang.png')\" alt=\"Avatar\">\r\n        </div>\r\n        <div class=\"user-name\">{{ sessionForm.xingming || sessionForm.guanlixingming || sessionForm.zhanghao }}</div>\r\n        <div class=\"user-role\">{{ userTableName == 'yonghu' ? '普通用户' : '管理员' }}</div>\r\n      </div>\r\n\r\n      <div class=\"side-menu\">\r\n        <div class=\"menu-item active\">个人资料</div>\r\n        <div class=\"menu-item\" @click=\"$router.push('/index/myForumList')\">我的发布</div>\r\n        <div class=\"menu-item\" @click=\"toStoreup\">我的收藏</div>\r\n        <div class=\"menu-item danger\" @click=\"logout\">退出登录</div>\r\n      </div>\r\n    </div>\r\n\r\n    <div class=\"content-wrapper\">\r\n      <div class=\"panel-header\">\r\n        <h3>个人资料设置</h3>\r\n      </div>\r\n\r\n      <el-form ref=\"sessionForm\" :model=\"sessionForm\" :rules=\"rules\" label-width=\"100px\" class=\"user-form\">\r\n        <template v-if=\"userTableName=='yonghu'\">\r\n          <el-form-item label=\"账号\" prop=\"zhanghao\">\r\n            <el-input v-model=\"sessionForm.zhanghao\" readonly disabled></el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"姓名\" prop=\"xingming\">\r\n            <el-input v-model=\"sessionForm.xingming\"></el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"性别\">\r\n            <el-radio-group v-model=\"sessionForm.xingbie\">\r\n              <el-radio label=\"男\">男</el-radio>\r\n              <el-radio label=\"女\">女</el-radio>\r\n            </el-radio-group>\r\n          </el-form-item>\r\n          <el-form-item label=\"手机号\" prop=\"shouji\">\r\n            <el-input v-model=\"sessionForm.shouji\"></el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"身份证\" prop=\"shenfenzheng\">\r\n            <el-input v-model=\"sessionForm.shenfenzheng\"></el-input>\r\n          </el-form-item>\r\n        </template>\r\n\r\n        <template v-if=\"userTableName=='putongguanliyuan'\">\r\n          <el-form-item label=\"管理账号\" prop=\"guanlizhanghao\">\r\n            <el-input v-model=\"sessionForm.guanlizhanghao\" readonly disabled></el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"姓名\" prop=\"guanlixingming\">\r\n            <el-input v-model=\"sessionForm.guanlixingming\"></el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"联系电话\" prop=\"lianxidianhua\">\r\n            <el-input v-model=\"sessionForm.lianxidianhua\"></el-input>\r\n          </el-form-item>\r\n        </template>\r\n\r\n        <el-form-item label=\"头像上传\">\r\n          <el-upload\r\n              class=\"avatar-uploader\"\r\n              :action=\"uploadUrl\"\r\n              :headers=\"headers\"\r\n              :show-file-list=\"false\"\r\n              :on-success=\"handleAvatarSuccess\">\r\n            <img v-if=\"sessionForm.touxiang\" :src=\"baseUrl + sessionForm.touxiang\" class=\"avatar\">\r\n            <i v-else class=\"el-icon-plus avatar-uploader-icon\"></i>\r\n          </el-upload>\r\n        </el-form-item>\r\n\r\n        <el-form-item>\r\n          <el-button type=\"primary\" @click=\"onSubmit('sessionForm')\">保存修改</el-button>\r\n        </el-form-item>\r\n      </el-form>\r\n    </div>\r\n\r\n    <el-dialog title=\"账户充值\" :visible.sync=\"dialogFormVisibleMoney\" width=\"500px\">\r\n      <el-form :model=\"chongzhiForm\">\r\n        <el-form-item label=\"充值金额\">\r\n          <el-input type=\"number\" v-model=\"chongzhiForm.money\" placeholder=\"请输入金额\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"支付方式\">\r\n          <el-radio-group v-model=\"chongzhiForm.radio\">\r\n            <el-radio label=\"微信支付\">微信</el-radio>\r\n            <el-radio label=\"支付宝支付\">支付宝</el-radio>\r\n          </el-radio-group>\r\n        </el-form-item>\r\n      </el-form>\r\n      <div slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button @click=\"dialogFormVisibleMoney = false\">取 消</el-button>\r\n        <el-button type=\"primary\" @click=\"chongzhi\">确 认</el-button>\r\n      </div>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport config from '@/config/config'\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      baseUrl: config.baseUrl,\r\n      // 【修复点】：login.vue 中存储的键名为 sessionTable，这里必须一致，否则为 null 导致接口 404\r\n      userTableName: localStorage.getItem('sessionTable'),\r\n      sessionForm: {},\r\n      headers: { Token: localStorage.getItem('Token') },\r\n      uploadUrl: config.baseUrl + 'file/upload',\r\n      rules: {\r\n        xingming: [{ required: true, message: '请输入姓名', trigger: 'blur' }],\r\n        shouji: [{ validator: this.$validate.isMobile, trigger: 'blur' }],\r\n        shenfenzheng: [{ validator: this.$validate.isIdCard, trigger: 'blur' }]\r\n      },\r\n      dialogFormVisibleMoney: false,\r\n      dialogFormVisibleVip: false,\r\n      chongzhiForm: { money: '', radio: '微信支付' }\r\n    };\r\n  },\r\n  created() {\r\n    this.getSession();\r\n  },\r\n  methods: {\r\n    getSession() {\r\n      // 如果 userTableName 为空，直接跳转回登录，避免发送错误请求\r\n      if(!this.userTableName) {\r\n        this.$router.push('/login');\r\n        return;\r\n      }\r\n      this.$http.get(`${this.userTableName}/session`).then(res => {\r\n        if (res.data.code == 0) {\r\n          this.sessionForm = res.data.data;\r\n          // 防止头像路径为空时的报错\r\n          if(!this.sessionForm.touxiang) this.sessionForm.touxiang = '';\r\n        }\r\n      });\r\n    },\r\n    handleAvatarSuccess(res) {\r\n      if (res.code == 0) {\r\n        this.sessionForm.touxiang = 'upload/' + res.file;\r\n        this.$forceUpdate();\r\n      }\r\n    },\r\n    onSubmit() {\r\n      this.$refs.sessionForm.validate(valid => {\r\n        if (valid) {\r\n          this.$http.post(`${this.userTableName}/update`, this.sessionForm).then(res => {\r\n            if (res.data.code == 0) {\r\n              this.$message.success('个人信息更新成功');\r\n              this.getSession(); // 刷新数据\r\n            }\r\n          });\r\n        }\r\n      });\r\n    },\r\n    chongzhi() {\r\n      if (!this.chongzhiForm.money || this.chongzhiForm.money <= 0) return this.$message.error('请输入有效金额');\r\n\r\n      this.sessionForm.money = parseFloat(this.sessionForm.money) + parseFloat(this.chongzhiForm.money);\r\n      this.$http.post(`${this.userTableName}/update`, this.sessionForm).then(res => {\r\n        if (res.data.code == 0) {\r\n          this.$message.success('充值成功');\r\n          this.dialogFormVisibleMoney = false;\r\n        }\r\n      });\r\n    },\r\n    chongzhivip() {\r\n      this.sessionForm.vip = '是';\r\n      this.$http.post(`${this.userTableName}/update`, this.sessionForm).then(res => {\r\n        if (res.data.code == 0) {\r\n          this.$message.success('开通成功，您已成为尊贵VIP');\r\n          this.dialogFormVisibleVip = false;\r\n          localStorage.setItem('vip', '是');\r\n        }\r\n      });\r\n    },\r\n    toStoreup() {\r\n      this.$router.push('/index/storeup');\r\n    },\r\n    logout() {\r\n      localStorage.clear();\r\n      this.$router.push('/index/home');\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.center-container {\r\n  width: 1200px;\r\n  margin: 20px auto;\r\n  display: flex;\r\n  gap: 20px;\r\n}\r\n\r\n/* 左侧边栏 */\r\n.sidebar-wrapper {\r\n  width: 280px;\r\n  background: #fff;\r\n  border-radius: 8px;\r\n  box-shadow: 0 1px 4px rgba(0,0,0,0.05);\r\n  padding: 30px 20px;\r\n  height: fit-content;\r\n\r\n  .user-profile-card {\r\n    text-align: center;\r\n    margin-bottom: 30px;\r\n    border-bottom: 1px solid #f0f0f0;\r\n    padding-bottom: 20px;\r\n\r\n    .avatar-box {\r\n      width: 100px;\r\n      height: 100px;\r\n      margin: 0 auto 15px;\r\n      border-radius: 50%;\r\n      overflow: hidden;\r\n      border: 2px solid #e0e0e0;\r\n      img { width: 100%; height: 100%; object-fit: cover; }\r\n    }\r\n\r\n    .user-name {\r\n      font-size: 18px;\r\n      font-weight: bold;\r\n      color: #333;\r\n      margin-bottom: 5px;\r\n    }\r\n\r\n    .user-role {\r\n      font-size: 12px;\r\n      color: #999;\r\n      margin-bottom: 10px;\r\n    }\r\n\r\n    .vip-tag {\r\n      font-size: 12px;\r\n      padding: 2px 8px;\r\n      border-radius: 10px;\r\n      background: #eee;\r\n      color: #666;\r\n      &.active { background: #fff7e6; color: #ff9900; border: 1px solid #ffcc80; }\r\n    }\r\n  }\r\n\r\n  .side-menu {\r\n    .menu-item {\r\n      padding: 12px 15px;\r\n      cursor: pointer;\r\n      border-radius: 6px;\r\n      color: #666;\r\n      transition: background 0.3s;\r\n      margin-bottom: 5px;\r\n\r\n      &:hover { background: #f5f7fa; color: #00c292; }\r\n      &.active { background: #e6f9f4; color: #00c292; font-weight: 500; }\r\n      &.danger { color: #f56c6c; &:hover { background: #fef0f0; } }\r\n    }\r\n  }\r\n}\r\n\r\n/* 右侧内容区 */\r\n.content-wrapper {\r\n  flex: 1;\r\n  background: #fff;\r\n  border-radius: 8px;\r\n  box-shadow: 0 1px 4px rgba(0,0,0,0.05);\r\n  padding: 30px 40px;\r\n\r\n  .panel-header {\r\n    border-bottom: 1px solid #f0f0f0;\r\n    margin-bottom: 30px;\r\n    padding-bottom: 15px;\r\n    h3 { margin: 0; font-size: 20px; color: #333; }\r\n  }\r\n\r\n  .user-form {\r\n    max-width: 600px;\r\n  }\r\n\r\n  .balance-box {\r\n    display: flex;\r\n    align-items: center;\r\n    .money { font-size: 20px; font-weight: bold; color: #ff5000; margin-right: 20px; }\r\n  }\r\n\r\n  .avatar-uploader {\r\n    /deep/ .el-upload {\r\n      border: 1px dashed #d9d9d9;\r\n      border-radius: 6px;\r\n      cursor: pointer;\r\n      position: relative;\r\n      overflow: hidden;\r\n      &:hover { border-color: #00c292; }\r\n    }\r\n    .avatar-uploader-icon {\r\n      font-size: 28px;\r\n      color: #8c939d;\r\n      width: 100px;\r\n      height: 100px;\r\n      line-height: 100px;\r\n      text-align: center;\r\n    }\r\n    .avatar {\r\n      width: 100px;\r\n      height: 100px;\r\n      display: block;\r\n      object-fit: cover;\r\n    }\r\n  }\r\n}\r\n</style>\r\n"]}]}